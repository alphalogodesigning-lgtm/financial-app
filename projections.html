<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projections - The Crystal Ball</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="./supabase-config.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: #0a0a0a;
            color: #E0E0E0;
            overflow-x: hidden;
        }

        .container {
            min-height: 100vh;
            padding: 24px;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Navigation */
        .main-nav {
            display: flex;
            gap: 12px;
            margin-bottom: 32px;
            padding: 16px;
            background: #1a1a1a;
            border: 1px solid #2a2a2a;
            border-radius: 12px;
            flex-wrap: wrap;
        }

        .nav-link {
            padding: 10px 20px;
            background: transparent;
            border: 1px solid #2a2a2a;
            border-radius: 8px;
            color: #888;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 14px;
        }

        .nav-link:hover {
            border-color: #D4AF37;
            color: #D4AF37;
        }

        .nav-link.active {
            background: linear-gradient(135deg, #D4AF37 0%, #FFD700 100%);
            color: #0a0a0a;
            border-color: #D4AF37;
        }

        .header {
            margin-bottom: 32px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px;
        }

        .header-title {
            font-size: 2rem;
            font-weight: 800;
            color: #fff;
            margin-bottom: 8px;
        }

        .header-subtitle {
            color: #888;
            font-size: 1rem;
        }

        .gold-text { color: #D4AF37; }
        .soft-blue-text { color: #89ABE3; }
        .green-text { color: #66BB6A; }
        .red-text { color: #FF6B6B; }

        .card {
            background: #1a1a1a;
            border: 1px solid #2a2a2a;
            border-radius: 16px;
            padding: 24px;
            transition: all 0.3s ease;
            margin-bottom: 24px;
        }

        .card:hover {
            border-color: #3a3a3a;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: #fff;
            margin-bottom: 20px;
        }

        .two-col {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
        }

        @media (max-width: 968px) {
            .two-col {
                grid-template-columns: 1fr;
            }
        }

        /* Mobile-only header/navigation optimization (desktop unchanged) */
        @media (max-width: 640px) {
            .main-nav {
                padding: 10px 16px;
                margin-bottom: 20px;
                gap: 8px;
                flex-wrap: nowrap;
                overflow-x: auto;
                overflow-y: hidden;
                -webkit-overflow-scrolling: touch;
                scroll-snap-type: x mandatory;
            }

            .main-nav::-webkit-scrollbar {
                display: none;
            }

            .nav-link {
                flex: 0 0 auto;
                white-space: nowrap;
                display: inline-flex;
                align-items: center;
                justify-content: center;
                min-height: 40px;
                padding: 10px 14px;
                border-radius: 999px;
                font-size: 13px;
                scroll-snap-align: start;
            }

            .nav-link.active {
                box-shadow: 0 6px 18px rgba(212, 175, 55, 0.22);
            }

            .header {
                margin-bottom: 20px;
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .header-title {
                font-size: 1.6rem;
                line-height: 1.15;
            }

            .header-subtitle {
                font-size: 0.95rem;
            }
        }

        /* Slider */
        .slider-group {
            margin-bottom: 24px;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .slider-name {
            font-weight: 600;
            color: #fff;
        }

        .slider-value {
            font-weight: 700;
            color: #D4AF37;
            font-size: 1.125rem;
        }

        input[type="range"] {
            width: 100%;
            height: 8px;
            background: #2a2a2a;
            border-radius: 4px;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: linear-gradient(135deg, #D4AF37 0%, #FFD700 100%);
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }

        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: linear-gradient(135deg, #D4AF37 0%, #FFD700 100%);
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }

        /* Impact Box */
        .impact-box {
            background: #0a0a0a;
            border: 1px solid #2a2a2a;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .impact-title {
            font-size: 0.875rem;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 12px;
        }

        .impact-value {
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 8px;
        }

        .impact-subtext {
            font-size: 0.875rem;
            color: #888;
        }

        /* Timeline */
        .timeline {
            position: relative;
            padding-left: 40px;
        }

        .timeline-line {
            position: absolute;
            left: 20px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #2a2a2a;
        }

        .timeline-item {
            position: relative;
            margin-bottom: 24px;
            padding: 16px;
            background: #0a0a0a;
            border: 1px solid #2a2a2a;
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .timeline-item:hover {
            border-color: #D4AF37;
        }

        .timeline-item.cluster {
            border-color: #FF6B6B;
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.05) 0%, rgba(255, 107, 107, 0.1) 100%);
        }

        .timeline-dot {
            position: absolute;
            left: -28px;
            top: 20px;
            width: 16px;
            height: 16px;
            background: #D4AF37;
            border-radius: 50%;
            border: 3px solid #0a0a0a;
        }

        .timeline-dot.cluster {
            background: #FF6B6B;
        }

        .timeline-date {
            font-weight: 700;
            color: #D4AF37;
            font-size: 0.875rem;
            margin-bottom: 8px;
        }

        .timeline-expenses {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .timeline-expense {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.875rem;
        }

        .timeline-expense-name {
            color: #fff;
        }

        .timeline-expense-amount {
            color: #888;
            font-weight: 600;
        }

        .timeline-total {
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid #2a2a2a;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 700;
        }

        .timeline-total-label {
            color: #888;
        }

        .timeline-total-amount {
            color: #D4AF37;
            font-size: 1.125rem;
        }

        /* Goal Progress */
        .goal-progress-bar {
            height: 12px;
            background: #2a2a2a;
            border-radius: 6px;
            overflow: hidden;
            margin: 16px 0;
        }

        .goal-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #D4AF37 0%, #FFD700 100%);
            border-radius: 6px;
            transition: width 0.5s ease;
        }

        .goal-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin-top: 16px;
        }

        .goal-stat {
            text-align: center;
        }

        .goal-stat-value {
            font-size: 1.5rem;
            font-weight: 800;
            color: #D4AF37;
        }

        .goal-stat-label {
            font-size: 0.75rem;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-top: 4px;
        }

        /* Scenario Cards */
        .scenario-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
        }

        .scenario-card {
            background: #0a0a0a;
            border: 1px solid #2a2a2a;
            border-radius: 12px;
            padding: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .scenario-card:hover {
            border-color: #D4AF37;
            transform: translateY(-2px);
        }

        .scenario-card.active {
            border-color: #D4AF37;
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.1) 0%, rgba(255, 215, 0, 0.1) 100%);
        }

        .scenario-title {
            font-weight: 700;
            color: #fff;
            margin-bottom: 8px;
        }

        .scenario-description {
            font-size: 0.875rem;
            color: #888;
            margin-bottom: 12px;
        }

        .scenario-impact {
            font-weight: 700;
            color: #66BB6A;
        }

        .scenario-impact.negative {
            color: #FF6B6B;
        }

        input[type="number"] {
            width: 100%;
            background: #0a0a0a;
            border: 1px solid #2a2a2a;
            border-radius: 8px;
            padding: 12px 16px;
            color: #E0E0E0;
            font-size: 16px;
            font-family: 'Inter', sans-serif;
            margin-top: 8px;
        }

        input[type="number"]:focus {
            outline: none;
            border-color: #D4AF37;
        }

        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #0a0a0a;
        }

        ::-webkit-scrollbar-thumb {
            background: #2a2a2a;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #3a3a3a;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        (() => {
        if (window.__projectionsInit) return;
        window.__projectionsInit = true;
        const { useState, useEffect } = React;

        const { supabaseClient, STORAGE_TABLE, waitForAuthSession } = window.SUPABASE_CONFIG;

        const resolveAuthSession = async () => {
            if (!supabaseClient) return null;
            const { data, error } = await supabaseClient.auth.getSession();
            if (error) throw error;
            if (data?.session) return data.session;
            const refreshed = await supabaseClient.auth.refreshSession();
            if (refreshed?.data?.session) return refreshed.data.session;
            return waitForAuthSession();
        };

        const getAuthenticatedUser = async () => {
            if (!supabaseClient) return null;
            const session = await resolveAuthSession();
            return session?.user || null;
        };

        const loadBudgetData = async () => {
            const fallback = localStorage.getItem('budgetTrackerData');
            if (!supabaseClient) {
                return fallback ? JSON.parse(fallback) : null;
            }
            try {
                const user = await getAuthenticatedUser();
                if (!user) {
                    window.location.href = 'auth.html';
                    return fallback ? JSON.parse(fallback) : null;
                }
                const { data, error } = await supabaseClient
                    .from(STORAGE_TABLE)
                    .select('data')
                    .eq('user_id', user.id)
                    .maybeSingle();
                if (error) throw error;
                if (data?.data) {
                    localStorage.setItem('budgetTrackerData', JSON.stringify(data.data));
                    return data.data;
                }
            } catch (err) {
                console.warn('Supabase load failed, using local data.', err);
            }
            return fallback ? JSON.parse(fallback) : null;
        };

        const INITIAL_DATA = {
            income: 5000,
            fixedExpenses: [],
            variableExpenses: [],
            streak: 0
        };

        function Projections() {
            const [data, setData] = useState(INITIAL_DATA);
            const [isHydrated, setIsHydrated] = useState(false);

            const START_MESSAGE = "Set income to begin";
            const income = Number.isFinite(data.income) ? data.income : 0;
            const incomeSet = income > 0;

            // What-if scenario state
            const [scenarioIncome, setScenarioIncome] = useState(incomeSet ? income : 1000);
            const [scenarioVariableSpend, setScenarioVariableSpend] = useState(100);
            const [activeScenario, setActiveScenario] = useState(null);

            // Goal state
            const [savingsGoal, setSavingsGoal] = useState(10000);
            const [monthlySavings, setMonthlySavings] = useState(500);

            useEffect(() => {
                let isMounted = true;
                loadBudgetData().then((saved) => {
                    if (!isMounted) return;
                    if (saved) {
                        setData(saved);
                    }
                    setIsHydrated(true);
                });
                return () => {
                    isMounted = false;
                };
            }, []);

            useEffect(() => {
                if (!isHydrated) return;
                if (Number.isFinite(data.income) && data.income > 0) setScenarioIncome(data.income);
                const currentVariableTotal = (data.variableExpenses || []).reduce((sum, exp) => sum + exp.amount, 0);
                setScenarioVariableSpend(currentVariableTotal > 0 ? 100 : 100);
            }, [data, isHydrated]);

            if (!incomeSet) {
                return (
                    <div className="container">
                        {/* Navigation */}
                        <nav className="main-nav">
                            <a href="index.html" className="nav-link">üìä Dashboard</a>
                            <a href="fixed-expenses.html" className="nav-link">‚öì Fixed Expenses</a>
                            <a href="variable-spending.html" className="nav-link">üí∏ Variable Spending</a>
                            <a href="projections.html" className="nav-link active">üîÆ Projections</a>
                            <a href="insights.html" className="nav-link">üß† Insights</a>
                        </nav>

                        {/* Header */}
                        <div className="header">
                            <div>
                                <h1 className="header-title">The Crystal Ball</h1>
                                <p className="header-subtitle">Play with scenarios and see your financial future</p>
                            </div>
                        </div>

                        <div className="card" style={{ textAlign: 'center', fontSize: '1.5rem', fontWeight: 800, color: '#D4AF37' }}>
                            {START_MESSAGE}
                        </div>
                    </div>
                );
            }

            // Calculations
            const fixedExpenses = data.fixedExpenses || [];
            const variableExpenses = data.variableExpenses || [];
            
            const totalFixed = fixedExpenses.reduce((sum, exp) => sum + exp.amount, 0);
            const totalVariable = variableExpenses.reduce((sum, exp) => sum + exp.amount, 0);
            const currentMonthlySpend = totalFixed + totalVariable;
            
            // Scenario calculations
            const projectedVariableSpend = (totalVariable * scenarioVariableSpend) / 100;
            const projectedMonthlySpend = totalFixed + projectedVariableSpend;
            const projectedRemaining = scenarioIncome - projectedMonthlySpend;
            const projectedAnnualSavings = projectedRemaining * 12;

            // Goal calculations
            const monthsToGoal = savingsGoal / monthlySavings;
            const goalDate = new Date();
            goalDate.setMonth(goalDate.getMonth() + Math.ceil(monthsToGoal));
            const progressPercent = (monthlySavings / (savingsGoal / 12)) * 100;

            // Expense timeline - next 30 days
            const today = new Date();
            const timelineData = [];
            
            for (let i = 0; i < 30; i++) {
                const date = new Date(today);
                date.setDate(today.getDate() + i);
                const day = date.getDate();
                
                const dayExpenses = fixedExpenses.filter(exp => exp.dueDate === day);
                
                if (dayExpenses.length > 0) {
                    const total = dayExpenses.reduce((sum, exp) => sum + exp.amount, 0);
                    timelineData.push({
                        date: date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }),
                        expenses: dayExpenses,
                        total,
                        isCluster: dayExpenses.length >= 3 || total > income * 0.3
                    });
                }
            }

            // Predefined scenarios
            const scenarios = [
                {
                    id: 'frugal',
                    title: 'üçú Frugal Mode',
                    description: 'Cut variable spending by 30%',
                    action: () => {
                        setScenarioVariableSpend(70);
                        setActiveScenario('frugal');
                    },
                    impact: (totalVariable * 0.3)
                },
                {
                    id: 'moderate',
                    title: 'üí∞ Moderate Saving',
                    description: 'Cut variable spending by 15%',
                    action: () => {
                        setScenarioVariableSpend(85);
                        setActiveScenario('moderate');
                    },
                    impact: (totalVariable * 0.15)
                },
                {
                    id: 'raise',
                    title: 'üìà Got a Raise',
                    description: 'Income increases by 10%',
                    action: () => {
                        setScenarioIncome(income * 1.1);
                        setActiveScenario('raise');
                    },
                    impact: (income * 0.1)
                },
                {
                    id: 'splurge',
                    title: 'üõçÔ∏è Splurge Month',
                    description: 'Variable spending up 50%',
                    action: () => {
                        setScenarioVariableSpend(150);
                        setActiveScenario('splurge');
                    },
                    impact: -(totalVariable * 0.5)
                }
            ];

            const resetScenario = () => {
                setScenarioIncome(data.income);
                setScenarioVariableSpend(100);
                setActiveScenario(null);
            };

            return (
                <div className="container">
                    {/* Navigation */}
                    <nav className="main-nav">
                        <a href="index.html" className="nav-link">üìä Dashboard</a>
                        <a href="fixed-expenses.html" className="nav-link">‚öì Fixed Expenses</a>
                        <a href="variable-spending.html" className="nav-link">üí∏ Variable Spending</a>
                        <a href="projections.html" className="nav-link active">üîÆ Projections</a>
                        <a href="insights.html" className="nav-link">üß† Insights</a>
                    </nav>

                    {/* Header */}
                    <div className="header">
                        <div>
                            <h1 className="header-title">The Crystal Ball</h1>
                            <p className="header-subtitle">Play with scenarios and see your financial future</p>
                        </div>
                    </div>

                    {/* What-If Scenarios */}
                    <div className="card">
                        <h2 className="card-title">What-If Scenarios</h2>
                        <p style={{ color: '#888', marginBottom: '20px' }}>
                            Try different financial scenarios and see how they impact your savings
                        </p>

                        <div className="scenario-grid">
                            {scenarios.map(scenario => (
                                <div 
                                    key={scenario.id}
                                    className={`scenario-card RM{activeScenario === scenario.id ? 'active' : ''}`}
                                    onClick={scenario.action}
                                >
                                    <div className="scenario-title">{scenario.title}</div>
                                    <div className="scenario-description">{scenario.description}</div>
                                    <div className={`scenario-impact RM{scenario.impact < 0 ? 'negative' : ''}`}>
                                        {scenario.impact >= 0 ? '+' : ''}RM{scenario.impact.toFixed(0)}/mo
                                    </div>
                                </div>
                            ))}
                        </div>

                        {activeScenario && (
                            <div style={{ marginTop: '20px', textAlign: 'center' }}>
                                <button 
                                    onClick={resetScenario}
                                    style={{
                                        background: 'transparent',
                                        border: '1px solid #2a2a2a',
                                        color: '#888',
                                        padding: '8px 16px',
                                        borderRadius: '8px',
                                        cursor: 'pointer',
                                        fontFamily: 'Inter, sans-serif',
                                        fontWeight: '600'
                                    }}
                                >
                                    Reset to Current
                                </button>
                            </div>
                        )}

                        <div className="two-col" style={{ marginTop: '32px' }}>
                            <div>
                                <div className="slider-group">
                                    <div className="slider-label">
                                        <span className="slider-name">Monthly Income</span>
                                        <span className="slider-value">RM{scenarioIncome.toFixed(0)}</span>
                                    </div>
                                    <input 
                                        type="range"
                                        min={100}
                                        max={5000}
                                        step="100"
                                        value={scenarioIncome}
                                        onChange={(e) => {
                                            setScenarioIncome(parseFloat(e.target.value));
                                            setActiveScenario('custom');
                                        }}
                                    />
                                </div>

                                <div className="slider-group">
                                    <div className="slider-label">
                                        <span className="slider-name">Variable Spending</span>
                                        <span className="slider-value">{scenarioVariableSpend.toFixed(0)}%</span>
                                    </div>
                                    <input 
                                        type="range"
                                        min="0"
                                        max="200"
                                        step="5"
                                        value={scenarioVariableSpend}
                                        onChange={(e) => {
                                            setScenarioVariableSpend(parseFloat(e.target.value));
                                            setActiveScenario('custom');
                                        }}
                                    />
                                    <div style={{ fontSize: '0.875rem', color: '#888', marginTop: '8px' }}>
                                        RM{projectedVariableSpend.toFixed(0)} per month
                                    </div>
                                </div>
                            </div>

                            <div>
                                <div className="impact-box">
                                    <div className="impact-title">Projected Monthly Savings</div>
                                    <div className={`impact-value RM{projectedRemaining >= 0 ? 'green-text' : 'red-text'}`}>
                                        RM{projectedRemaining.toFixed(0)}
                                    </div>
                                    <div className="impact-subtext">
                                        vs RM{(data.income - currentMonthlySpend).toFixed(0)} currently
                                    </div>
                                </div>

                                <div className="impact-box">
                                    <div className="impact-title">Projected Annual Savings</div>
                                    <div className={`impact-value RM{projectedAnnualSavings >= 0 ? 'gold-text' : 'red-text'}`}>
                                        RM{projectedAnnualSavings.toFixed(0)}
                                    </div>
                                    <div className="impact-subtext">
                                        That's {projectedRemaining >= 0 ? 
                                            `${((projectedRemaining / scenarioIncome) * 100).toFixed(1)}% of your income` :
                                            "you'll be in the red"}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Savings Goal */}
                    <div className="card">
                        <h2 className="card-title">Savings Goal Simulator</h2>
                        <p style={{ color: '#888', marginBottom: '20px' }}>
                            Set a goal and see when you'll reach it
                        </p>

                        <div className="two-col">
                            <div>
                                <label style={{ fontSize: '0.875rem', color: '#888', display: 'block', marginBottom: '8px' }}>
                                    SAVINGS GOAL
                                </label>
                                <input 
                                    type="number"
                                    value={savingsGoal}
                                    onChange={(e) => setSavingsGoal(parseFloat(e.target.value) || 0)}
                                    placeholder="10000"
                                />
                            </div>

                            <div>
                                <label style={{ fontSize: '0.875rem', color: '#888', display: 'block', marginBottom: '8px' }}>
                                    MONTHLY CONTRIBUTION
                                </label>
                                <input 
                                    type="number"
                                    value={monthlySavings}
                                    onChange={(e) => setMonthlySavings(parseFloat(e.target.value) || 0)}
                                    placeholder="500"
                                />
                            </div>
                        </div>

                        <div className="goal-progress-bar">
                            <div 
                                className="goal-progress-fill"
                                style={{ width: `RM{Math.min(progressPercent, 100)}%` }}
                            />
                        </div>

                        <div className="goal-stats">
                            <div className="goal-stat">
                                <div className="goal-stat-value">{Math.ceil(monthsToGoal)}</div>
                                <div className="goal-stat-label">Months to Goal</div>
                            </div>
                            <div className="goal-stat">
                                <div className="goal-stat-value">
                                    {goalDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' })}
                                </div>
                                <div className="goal-stat-label">Target Date</div>
                            </div>
                            <div className="goal-stat">
                                <div className="goal-stat-value">
                                    RM{(monthlySavings * 12).toFixed(0)}
                                </div>
                                <div className="goal-stat-label">Annual Savings</div>
                            </div>
                        </div>

                        {progressPercent > 100 && (
                            <div style={{ 
                                marginTop: '16px', 
                                padding: '12px', 
                                background: 'linear-gradient(135deg, rgba(102, 187, 106, 0.1) 0%, rgba(76, 175, 80, 0.1) 100%)',
                                border: '1px solid #66BB6A',
                                borderRadius: '8px',
                                color: '#66BB6A',
                                textAlign: 'center',
                                fontWeight: '600'
                            }}>
                                üéâ You're on track! You'll reach your goal even faster than expected!
                            </div>
                        )}

                        {monthlySavings > projectedRemaining && projectedRemaining > 0 && (
                            <div style={{ 
                                marginTop: '16px', 
                                padding: '12px', 
                                background: 'linear-gradient(135deg, rgba(255, 215, 0, 0.1) 0%, rgba(212, 175, 55, 0.1) 100%)',
                                border: '1px solid #D4AF37',
                                borderRadius: '8px',
                                color: '#D4AF37',
                                textAlign: 'center',
                                fontWeight: '600'
                            }}>
                                ‚ö†Ô∏è Your goal requires RM{monthlySavings}/mo but you're only saving RM{projectedRemaining.toFixed(0)}/mo
                            </div>
                        )}
                    </div>

                    {/* Upcoming Expense Timeline */}
                    <div className="card">
                        <h2 className="card-title">Upcoming Expense Clusters</h2>
                        <p style={{ color: '#888', marginBottom: '20px' }}>
                            Days when multiple fixed expenses hit (brace yourself üòÖ)
                        </p>

                        {timelineData.length === 0 ? (
                            <p style={{ color: '#888', textAlign: 'center', padding: '40px' }}>
                                No fixed expenses scheduled in the next 30 days.
                            </p>
                        ) : (
                            <div className="timeline">
                                <div className="timeline-line"></div>
                                {timelineData.map((item, index) => (
                                    <div 
                                        key={index}
                                        className={`timeline-item RM{item.isCluster ? 'cluster' : ''}`}
                                    >
                                        <div className={`timeline-dot RM{item.isCluster ? 'cluster' : ''}`}></div>
                                        <div className="timeline-date">
                                            {item.date}
                                            {item.isCluster && <span style={{ marginLeft: '8px', color: '#FF6B6B' }}>‚ö†Ô∏è Heavy Day</span>}
                                        </div>
                                        <div className="timeline-expenses">
                                            {item.expenses.map(exp => (
                                                <div key={exp.id} className="timeline-expense">
                                                    <span className="timeline-expense-name">{exp.name}</span>
                                                    <span className="timeline-expense-amount">RM{exp.amount.toFixed(2)}</span>
                                                </div>
                                            ))}
                                        </div>
                                        <div className="timeline-total">
                                            <span className="timeline-total-label">Daily Total</span>
                                            <span className="timeline-total-amount">RM{item.total.toFixed(2)}</span>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        ReactDOM.render(<Projections />, document.getElementById('root'));
        })();
    </script>
</body>
</html>
